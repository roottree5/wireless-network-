# 스마트 도어락 시스템 프로젝트_곽대혁

## 프로젝트 개요
스마트 도어락 프로젝트는 지문 인식과 RFID를 이용한 사용자 인증 시스템을 기반으로,  
PWA(Progressive Web App)를 통해 실시간으로 도어락 상태를 확인하고 제어할 수 있는 스마트 보안 솔루션입니다.

## 주요 기능
1. **사용자 인증**:  
   - 지문 및 RFID 모듈을 사용한 다중 인증 방식 제공.
   - 인증 성공 시 도어락 작동.
2. **실시간 데이터 관리**:  
   - Wi-Fi 모듈을 활용해 인증 및 도어락 작동 정보를 DB에 저장.
   - 사용자 접근 이력 및 도어락 상태 모니터링.
3. **PWA 지원**:  
   - 플랫폼에 구애받지 않고 웹과 앱에서 MQTT 통신을 활용해 도어락을 원격 제어.

## 구현 기술
### **하드웨어**  
1. **아두이노 기반 회로 설계**:  
    - 지문 인식 센서, RFID 모듈, ESP8266 와이파이 모듈, 릴레이 모듈을 사용하여 통합 회로 설계 및 구현.
2. **지문 인식 및 RFID 모듈**:  
    - 사용자 인증 및 데이터 전송.
3. **릴레이 모듈**:  
    - 인증 성공 시 도어락 제어.  
 
### **소프트웨어**  
1. **PWA(Progressive Web App)**:  
    - HTML, CSS, JavaScript로 구현하여 다양한 플랫폼(iOS, Android, Windows)에서 작동.
2. **데이터베이스**:  
    - 사용자 정보 및 인증 기록을 클라우드에 저장하여 관리.
3. **MQTT 통신**:  
    - PWA에서 발생한 명령을 실시간으로 라즈베리파이가 아두이노로 전송하여 도어락 작동.
  
## 프로젝트 목표
**스마트 홈 환경에서 사용자의 보안과 편의성을 극대화하는 도어락 시스템 구축.**

---

## 하드웨어 파트  

### **1. [회로 설계](fingerprint_RFID.fzz)**  
스마트 도어락 시스템의 하드웨어 설계는 안정성과 통합성을 고려하여 다음과 같이 구성되었습니다.  

- **지문 인식 센서 및 RFID 모듈 연결**:  
  - 아두이노 보드에 센서 및 모듈을 연결하여 데이터 수집 및 인증 기능을 구현.
- **릴레이 모듈 설계**:  
  - 인증 성공 시 도어락을 제어하기 위해 릴레이 모듈을 활용하여 전기 신호를 제어.
    
![image](https://github.com/user-attachments/assets/610529ab-02e5-44ce-ab20-c67c27a41b1c)


### **2. 사용자 등록/삭제 기능**  
사용자 관리의 핵심 기능으로 등록 및 삭제 프로세스를 switch-case문을 사용해 다음과 같이 구현했습니다.  
- [**지문 등록/삭제**](fingerprint_management.ino):
  - 지문 인식 센서를 통해 지문 데이터를 캡처하여 고유 ID로 저장, 고유 ID를 사용해 지문 정보 삭제 기능 구현.
- [**RFID 카드 등록/삭제**](RFID_management.ino):  
  - RFID 모듈에서 인식한 카드의 UID를 등록/삭제 기능을 구현.

### **3. [사용자 인증 후 도어락 작동 기능](fingerprint_rfid_event.ino)**  
- **사용자 인증**:  
  - 사용자가 지문 센서 또는 RFID 태그를 통해 인증을 시도하면 등록된 사용자 정보와 대조하여 인증 여부 판별.
- **인증 실패 카운터**:  
  - 지문과 RFID의 실패 카운터를 각각 적용하여 등록되지 않은 사용자가 n회 이상 인증 실패 시 이벤트 발생.
- **도어락 작동**:   
  - 인증이 성공하면 아두이노가 릴레이 모듈을 제어하여 도어락을 열고 닫음.
  
---

## [하드웨어 파트 진행 중 발생한 문제와 해결 방안](https://github.com/roottree5/wireless-network-/issues/6)   

### **1. 지문 등록/삭제 및 카드 등록/삭제 코드 통합 문제**  
- **문제**:  
  - 지문 등록/삭제와 카드 등록/삭제 기능을 통합하여 처리하려 했으나, 동적 메모리 부족 이슈가 발생.  
  - 아두이노의 동적 메모리가 90% 이상 사용되었으며, 지역 변수가 부족해 코드 실행 중 안정성이 떨어지는 문제가 확인됨.  
- **해결 방안**:  
  - 지문 등록/삭제와 카드 등록/삭제 기능을 개별 코드로 분리하여 메모리 점유율을 낮춤.  
  - 코드 간 독립성을 유지해 메모리 사용량 최적화.  


### **2. 신규 지문 등록 시 슬롯 덮어쓰기 문제**  
- **문제**:  
  - 지문 센서에서 신규 지문을 등록할 때, 센서의 메모리 슬롯(1~127) 중 하나를 선택해야 함.  
  - 사용자가 기존 지문이 저장된 슬롯을 선택하면 기존 지문 정보가 삭제되고 신규 지문 정보로 덮어씌워지는 문제가 발생.  
- **해결 방안**:  
  - **DB 연동을 통한 무결성 검사 구현 예정**:  
    - 신규 지문 등록 시 데이터베이스에서 사용 가능한 슬롯 정보를 확인하여 중복 선택 방지.  
    - 슬롯 정보(id)를 동적으로 가져와 센서에 저장하는 방식으로 처리하여 데이터 무결성을 유지.  


### **3. RFID 모듈 인증 방식의 제한**  
- **문제**:  
  - RFID 모듈은 단순히 UID를 읽어오는 스캐너 역할만 수행하며, 지문 센서와 달리 자체적으로 등록 및 비교 기능이 없음.  
  - 현재는 UID를 코드 내 리스트에 직접 입력하여 인증을 처리하고 있어 확장성이 부족함.
- **해결 방안**:  
  - **DB 연동으로 UID 관리 기능 강화 예정**:  
    - RFID 카드 등록/삭제 단계에서 인식한 카드 UID 정보를 데이터베이스에 업로드해 관리함.
    - RFID 인증 시 사용자가 등록한 UID를 데이터베이스에서 가져와 이를 비교하여 인증을 수행하도록 코드 업데이트 예정.   

